(()=>{"use strict";var e={};(()=>{var t=e;function n(e){return"number"==typeof e&&e>=0&&!(e%1)}Object.defineProperty(t,"__esModule",{value:!0}),t.matchManyTimes=t.matchUnits=t.MatchEnv=t.walker=t.getRange=void 0,t.matchUnits=function(e,t,n){const r=t.map((e=>e.walker(null))),s=r.map(((e,t)=>t)),i=e&&t.map((t=>t.walker(e)));return function(e,t){let o,u;const c=e.found;if(e.found=[],function s(c){const f=e.store(),h=c.length;for(let l=0;l<h;l+=1){const a=c[l];if(r[a](e,!1)){if(h>1&&s(c.slice(0,l).concat(c.slice(l+1))))return!0;if(n&&h>1)e.restore(f);else if(!i&&!t||(e.restore(f),(i||r)[a](e,t))){if(e.compareIndex(o)<0&&(u=e.found.slice(),o=e.index,e.isSuccess(!0,0)))return!0;e.restore(f)}}}}(s),e.found=c,u)return c.push(...u),e.index=o,!0}},t.matchManyTimes=function(e,t,n,r,s){const i=t.walker(null);if(e){const o=t.walker(e);return s?function(t,s){if(n<=0&&e(t,s))return!0;if(r>0){const e=t.store();let u=1;for(;;){if(u>=n&&o(t,s))return!0;if(++u>r||!i(t,!1))break}t.restore(e)}}:function(t,s){return function u(c){const f=t.store();return!!(c<r&&i(t,!1)&&(u(c+1)||(t.restore(f),c>=n-1&&o(t,s))))||(!!(c>=n&&e(t,s))||void 0)}(0)}}return function(e,t){return function s(o){if(o<r){const r=e.store();if(i(e,!1)&&(s(o+1)||(e.restore(r),t&&o>=n-1&&i(e,!0))))return!0}if(o>=n&&e.isSuccess(t,0))return!0}(0)}},t.walker=function(e){return function(t){return t?function(n,r,s){const i=n.store();if(e(n,!1,s)){if(t(n,r))return!0;n.restore(i)}}:e}},t.MatchEnv=class{constructor(e,t){this.tokens=e,this.pattern=t,this.found=[],this.success=!1;let n=0;this.token=e[n],Object.defineProperties(this,{index:{get:()=>n,set(e){n=e,this.token=this.tokens[n]}}})}store(){return[this.index,this.found.length]}restore([e,t]){this.index=e,this.found.length=t}next(){const{index:e,tokens:t}=this;return t.length>e&&(this.index=e+1),e}prev(){const e=this.index;return e>0&&(this.index=e-1),e}compareIndex(e=-1){return e-this.index}isSuccess(e,t){return!e||this.index>=this.tokens.length-t}},t.getRange=function(e){let t=0,r=e[t];const s=[r,r];do{r=e[t],n(r),s[t>>1]=r,t+=2,t-1<e.length&&(","!==e[t-1].value||(s[t>>1]=Number.MAX_SAFE_INTEGER))}while(t<e.length);return s}})();var t=exports;for(var n in e)t[n]=e[n];e.__esModule&&Object.defineProperty(t,"__esModule",{value:!0})})();
//# sourceMappingURL=utils.js.map